name: Continuous Integration

on:
  pull_request:
  merge_group:
  push:
    branches: [huan/test]

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: ${{ github.ref_name != 'main' }}

jobs:
  runtime_api_coverage:
    name: Runtime API coverage
    uses: jstz-dev/jstz/.github/workflows/runtime-api-coverage.yml@huan/test
    secrets:
      repo_token: ${{ secrets.TEST_REPO_TOKEN }}
    with:
      target_repo: huancheng-trili/test-matrix
      target_branch: test
      build_ref: huan/test
      deploy_report: true